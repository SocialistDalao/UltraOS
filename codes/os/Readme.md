### 文件包结构
内核代码仅存在于src文件夹下，其下文件夹构造如下：
- drivers：串口以及sd卡驱动，包括qemu版本。
- fs：FAT32虚拟文件系统对内核的支持，包括管道以及标准输入输出等抽象文件以及实体文件。
- mm：内存管理。
- syscall：系统调用的判断及处理模块。
- task：进程处理模块，包括进程、处理器核、调度器、上下文等。
- trap：trap以及用户上下文相关逻辑。

src文件下的其他文件

- config.rs：全局的配置参数。
- console.rs：内核标准输出。
- entry.asm：内核入口代码。
- lang_items.rs：内核辅助函数。
- linker-***.ld：链接脚本，用来组织内核代码的地址位置。
- main：内核初始化函数。
- monitor.rs：混合调试模块。
- sbi.rs：sbi的ecall指令。
- start_app.S：嵌入内核的初始进程。
- timer.rs：时钟模块
- utils.rs: 功能性库

注意，内核的start_app.S会嵌入上一级user文件夹下的两个初始进程，这和内核分开，如果想要更新初始进程需要更新用户代码并生成程序才可。

### 使用

> make run

该命令将直接在qemu上运行UltraOS。该命令会首先编译我们准备好的测试代码，之后将其程序以及我们所参加的操作系统大赛给出的官方测试文件一同烧录到我们准备的文件镜像中，然后开始编译内核文件，与SBI拼接后生成裸运行文件，通过qemu运行。注意，我们虽然与RustSBI进行合并，但是最后我们并没有使用它，而是换成了OpenSBI，因为RustSBI在qemu下没有开启浮点运算，在k210平台则继续使用了RustSBI（UltraOS定制版本）。

> make run BOARD=k210

该命令将生成内核文件，并且直接在k210上运行UltraOS。但是，为了能够运行更多的程序，请在k210上插入sd卡，并在里面放置预备文件和程序，UltraOS会将其作为文件系统控制的外存进行使用。同时，需要注意的是，为了支持比赛的进行，我们的UltraOS会自行运行

> make gdb

> make monitor

这一组命令分别在两个窗口运行，即可启动gdb调试。